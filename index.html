<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arkanat Guard System</title>
    <link rel="icon" type="image/svg+xml" href="https://arkanat.com.sa/wp-content/uploads/2024/07/logo.svg">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">
</head>

<body class="bg-slate-900">

    <div id="landing-page" class="page active flex-col justify-center items-center p-4 sm:p-8">
        <div class="w-full max-w-5xl text-center">
            <img src="https://arkanat.com.sa/wp-content/uploads/2024/07/logo.svg" alt="شعار اركانات" class="h-20 sm:h-24 mb-6 mx-auto" onerror="this.onerror=null; this.src='https://placehold.co/200x70/FFFFFF/000000?text=Arkanat';">
            <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold mb-4 text-white">نظام ادارة الحراسات الالكتروني</h1>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-12">
                 <div class="login-option-card" data-role="guard"><i class="ph-fill ph-user text-blue-400 text-5xl"></i><h3 class="text-xl font-bold mt-4 text-white">دخول الحارس</h3><p class="text-gray-400 text-sm mt-1">تسجيل الحضور وتقديم الطلبات</p></div>
                 <div class="login-option-card" data-role="coverage_guard"><i class="ph-fill ph-users text-teal-400 text-5xl"></i><h3 class="text-xl font-bold mt-4 text-white">حراس التغطيات</h3><p class="text-gray-400 text-sm mt-1">عرض وتقديم على التغطيات</p></div>
                 <div class="login-option-card" data-role="admin"><i class="ph-fill ph-shield-check text-green-400 text-5xl"></i><h3 class="text-xl font-bold mt-4 text-white">دخول المشرف</h3></div>
                 <div class="login-option-card" data-role="operations"><i class="ph-fill ph-chart-line-up text-indigo-400 text-5xl"></i><h3 class="text-xl font-bold mt-4 text-white">إدارة العمليات</h3></div>
                 <div class="login-option-card" data-role="hr"><i class="ph-fill ph-users-three text-orange-400 text-5xl"></i><h3 class="text-xl font-bold mt-4 text-white">الموارد البشرية</h3></div>
                 <div class="login-option-card" data-role="contracts"><i class="ph-fill ph-file-text text-purple-400 text-5xl"></i><h3 class="text-xl font-bold mt-4 text-white">إدارة العقود</h3></div>
            </div>
             <div class="mt-16 text-center">
                 <p class="glowing-text text-gray-300 text-lg">نسخة تجريبية لمعاينة النظام</p>
                 <p class="text-gray-500 text-sm mt-2">تم تصميمه وبرمجته بالكامل من يزيد الصايل.</p>
             </div>
        </div>
    </div>

    <div id="login-page" class="page justify-center items-center bg-slate-900 p-4">
        <div class="w-full max-w-md bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl p-8 space-y-6">
            <div class="text-center"><h2 id="login-title" class="text-3xl font-bold text-white">تسجيل الدخول</h2></div>
            <div><label for="login-id" class="block text-sm font-medium text-gray-300 mb-2">اسم المستخدم</label><input type="text" id="login-id" class="w-full p-3 bg-slate-700 text-white border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 transition"></div>
            <div><label for="login-password" class="block text-sm font-medium text-gray-300 mb-2">كلمة المرور</label><input type="password" id="login-password" class="w-full p-3 bg-slate-700 text-white border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 transition"></div>
            <button id="login-btn" class="w-full bg-blue-600 text-white p-3 rounded-lg font-bold hover:bg-blue-700 transition">دخول</button>
            <button id="login-back-btn" class="w-full bg-slate-700 text-gray-300 p-3 rounded-lg font-bold hover:bg-slate-600 transition">رجوع</button>
        </div>
    </div>
    
    <div id="guard-dashboard-page" class="page flex-col justify-center items-center bg-slate-900 p-4">
        <div class="w-full max-w-5xl bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl">
             <div class="p-6 border-b border-slate-700 flex justify-between items-center"><h2 class="text-2xl font-bold text-white">مرحباً بك، <span id="guard-name-display"></span></h2><button class="logout-btn header-btn bg-red-600 hover:bg-red-700">تسجيل الخروج</button></div>
            <div id="guard-buttons-container" class="p-6 grid grid-cols-2 md:grid-cols-4 gap-4">
                <button id="check-in-btn" class="dashboard-action-btn check-in"><i class="ph-fill ph-fingerprint text-4xl"></i>تسجيل حضور</button>
                <button id="check-out-btn" class="dashboard-action-btn check-out"><i class="ph-fill ph-sign-out text-4xl"></i>انصراف من الموقع</button>
                <button id="view-my-schedule-btn" class="dashboard-action-btn request"><i class="ph-fill ph-calendar-check text-4xl"></i>عرض جدولي</button>
                <button class="dashboard-action-btn request" data-modal="leave-modal"><i class="ph-fill ph-calendar-plus text-4xl"></i>طلب إجازة</button>
                <button class="dashboard-action-btn request" data-modal="loan-modal"><i class="ph-fill ph-money text-4xl"></i>طلب سلفة</button>
                <button class="dashboard-action-btn request" data-modal="permission-modal"><i class="ph-fill ph-timer text-4xl"></i>طلب استئذان</button>
                <button class="dashboard-action-btn request" data-modal="overtime-modal"><i class="ph-fill ph-clock-clockwise text-4xl"></i>طلب عمل إضافي</button>
                <button class="dashboard-action-btn request" data-modal="resignation-modal"><i class="ph-fill ph-door-open text-4xl"></i>طلب استقالة</button>
            </div>
        </div>
    </div>
    
    <div id="coverage-guard-dashboard-page" class="page flex-col items-center bg-slate-900 p-4 sm:p-6 md:p-8 w-full">
         <div class="w-full max-w-full lg:max-w-7xl bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl">
               <div class="p-4 sm:p-6 border-b border-slate-700 flex flex-col sm:flex-row justify-between items-center gap-4">
                   <h2 class="text-xl sm:text-2xl font-bold text-white">لوحة تحكم حراس التغطيات: <span id="coverage-guard-name-display"></span></h2>
                   <button class="logout-btn header-btn bg-red-600 hover:bg-red-700">تسجيل الخروج</button>
               </div>
               <div class="border-b border-slate-700 p-2">
                <nav id="coverage-guard-tabs" class="flex space-x-2 overflow-x-auto" aria-label="Tabs">
                       <a href="#" data-tab="available_coverages" class="custom-tab active-tab">التغطيات المتوفرة</a>
                       <a href="#" data-tab="my_coverages" class="custom-tab">تغطياتي</a>
                </nav>
               </div>
               <div id="coverage-guard-tab-content" class="p-4"></div>
         </div>
    </div>

    <div id="admin-dashboard-page" class="page flex-col items-center bg-slate-900 p-4 sm:p-6 md:p-8 w-full">
         <div class="w-full max-w-full lg:max-w-7xl bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl">
               <div class="p-4 sm:p-6 border-b border-slate-700 flex flex-col sm:flex-row justify-between items-center gap-4">
                   <h2 id="admin-dashboard-title" class="text-xl sm:text-2xl font-bold text-white">لوحة التحكم</h2>
                   <div id="admin-header-actions" class="flex flex-wrap justify-center sm:justify-end items-center gap-3">
                       </div>
               </div>
               <div class="border-b border-slate-700 p-2"><nav id="admin-ops-tabs" class="flex space-x-2 overflow-x-auto" aria-label="Tabs"></nav></div>
               <div id="admin-tab-content" class="p-4"></div>
         </div>
    </div>
    
    <div id="hr-dashboard-page" class="page flex-col items-center bg-slate-900 p-4 sm:p-6 md:p-8 w-full">
        <div class="w-full max-w-full lg:max-w-7xl bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl">
            <div class="p-4 sm:p-6 border-b border-slate-700 flex flex-col sm:flex-row justify-between items-center gap-4">
                <div id="hr-header-content">
                    <h2 class="text-xl sm:text-2xl font-bold text-white">لوحة تحكم الموارد البشرية</h2>
                </div>
                 <div id="hr-header-actions" class="flex flex-wrap justify-center sm:justify-end items-center gap-3">
                     </div>
            </div>

            <div id="hr-dashboard-content" class="p-4 sm:p-6">
                <div id="hr-menu-view" class="active">
                    <div id="hr-menu-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
                        </div>
                </div>

                <div id="hr-content-view" class="hidden">
                    </div>
            </div>

        </div>
    </div>

    <div id="contracts-dashboard-page" class="page flex-col items-center bg-slate-900 p-4 sm:p-6 md:p-8 w-full">
    <div class="w-full max-w-full lg:max-w-7xl bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl">
        <div class="p-4 sm:p-6 border-b border-slate-700 flex flex-col sm:flex-row justify-between items-center gap-4">
            <h2 class="text-xl sm:text-2xl font-bold text-white">إدارة العقود: <span id="contracts-user-name-display"></span></h2>
            <div class="flex items-center gap-3">
                <button id="add-contract-btn" class="header-btn bg-green-600 hover:bg-green-700"><i class="ph ph-plus-circle mr-2"></i> إنشاء عقد جديد</button>
                <button class="logout-btn header-btn bg-red-600 hover:bg-red-700">تسجيل الخروج</button>
            </div>
        </div>
        <!-- Search Bar -->
        <div class="p-4 border-b border-slate-700">
            <input type="text" id="search-contracts" class="w-full p-3 bg-slate-700 text-white border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 transition" placeholder="ابحث باسم العقد أو الشركة...">
        </div>
        <div id="contracts-list-container" class="p-4">
            <!-- Contracts will be rendered here by JS -->
        </div>
    </div>
</div>
    
    <div id="contract-view-page" class="page flex-col items-start bg-slate-900 p-4 sm:p-8 w-full overflow-y-auto">
        <div class="w-full max-w-5xl mx-auto">
            <div class="w-full mb-4 flex justify-between items-center no-print">
                <button id="contract-view-back-btn" class="header-btn bg-slate-600 hover:bg-slate-500 flex items-center gap-2"><i class="ph ph-arrow-right"></i> رجوع للوحة التحكم</button>
                <button id="print-contract-btn" class="header-btn bg-blue-600 hover:bg-blue-700 flex items-center gap-2"><i class="ph ph-printer"></i> طباعة العقد</button>
            </div>
            <div id="contract-document" class="w-full bg-white rounded-lg shadow-2xl p-8 sm:p-12 text-slate-800">
                <div class="flex justify-between items-center border-b-2 border-slate-300 pb-4 mb-8">
                    <div>
                        <h1 class="text-3xl font-bold text-slate-900">عقد تقديم خدمات حراسات أمنية</h1>
                        <p class="text-sm text-slate-500">Contract for Security Guard Services</p>
                    </div>
                    <img src="https://arkanat.com.sa/wp-content/uploads/2024/07/logo.svg" alt="شعار اركانات" class="h-16" onerror="this.onerror=null; this.src='https://placehold.co/150x60/FFFFFF/000000?text=Arkanat';">
                </div>
                
                <div id="contract-body" class="space-y-8 leading-relaxed">
                    <div id="parties-section"></div>
                    <div id="details-section"></div>
                    <div id="financials-section"></div>
                    <div id="notes-section"></div>
                    <div id="signatures-section" class="pt-16">
                        <h3 class="text-xl font-bold mb-8 text-center border-t border-slate-200 pt-8">التواقيع / Signatures</h3>
                        <div class="grid grid-cols-2 gap-16">
                            <div class="text-center">
                                <p class="font-bold">الطرف الأول</p>
                                <p class="text-sm text-slate-600">First Party (Arkanat)</p>
                                <div class="border-b-2 border-slate-400 border-dashed mt-16 mb-2"></div>
                                <p class="text-xs">الاسم والتوقيع</p>
                            </div>
                            <div class="text-center">
                                <p class="font-bold">الطرف الثاني</p>
                                <p id="second-party-name" class="text-sm text-slate-600">Second Party (Client)</p>
                                <div class="border-b-2 border-slate-400 border-dashed mt-16 mb-2"></div>
                                <p class="text-xs">الاسم والتوقيع والختم الرسمي</p>
                            </div>
                        </div>
                    </div>
                </div>
                 <div class="text-center text-xs text-slate-400 border-t border-slate-200 mt-12 pt-4">
                    <p>هذا العقد إلكتروني ومعتمد من نظام إدارة الحراسات - شركة اركانات للحراسات الأمنية</p>
                    <p id="contract-footer-info"></p>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-container" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50 p-4 overflow-y-auto">
        <div class="modal-content flex-col w-full max-w-3xl bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="guard-form-modal">
            <h3 id="guard-form-title-text" class="text-xl font-bold p-4 border-b border-slate-700"></h3>
            <div class="p-6 space-y-6 max-h-[80vh] overflow-y-auto">
                <input type="hidden" id="guard-form-id">
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
                    <input id="guard-form-name" type="text" placeholder="اسم الحارس الكامل" class="p-2 border bg-slate-700 border-slate-600 rounded-md md:col-span-3">
                    <input id="guard-form-national-id" type="text" placeholder="رقم الهوية" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                    <input id="guard-form-mobile" type="text" placeholder="رقم الجوال" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                    <input id="guard-form-password" type="text" placeholder="كلمة المرور (اتركه فارغاً لعدم التغيير)" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                    <input id="guard-form-job-title" type="text" placeholder="المسمى الوظيفي" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                    <input id="guard-form-location" type="text" placeholder="الموقع" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                    <input id="guard-form-region" type="text" placeholder="المنطقة" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                    <input id="guard-form-project" type="text" placeholder="المشروع" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                     <div>
                         <label for="guard-form-status" class="block text-sm font-medium text-gray-300 mb-1">حالة الموظف</label>
                         <select id="guard-form-status" class="filter-select">
                             <option value="اساسي">أساسي</option>
                             <option value="بديل">بديل</option>
                         </select>
                     </div>
                    <input id="guard-form-basic-salary" type="number" placeholder="راتب اساسي" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                    <input id="guard-form-housing-allowance" type="number" placeholder="بدل سكن" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                    <input id="guard-form-transport-allowance" type="number" placeholder="بدل نقل" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                    <input id="guard-form-other-allowances" type="number" placeholder="بدلات اخرى" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                </div>
                <fieldset class="border border-slate-600 p-4 rounded-lg">
                    <legend class="px-2 font-semibold text-gray-300">جدول الدوام الأسبوعي</legend>
                    <div id="guard-form-schedule-container" class="space-y-2"></div>
                </fieldset>
            </div>
            <div class="p-4 bg-slate-900 flex justify-end gap-3"><button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button><button id="submit-guard-form-btn" class="font-semibold bg-blue-600 text-white px-4 py-2 rounded-lg transition hover:bg-blue-700">حفظ</button></div>
        </div>

        <div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="coverage-guard-form-modal">
            <h3 id="coverage-guard-form-title" class="text-xl font-bold p-4 border-b border-slate-700"></h3>
            <input type="hidden" id="coverage-guard-form-id">
            <div class="p-6 grid grid-cols-1 sm:grid-cols-2 gap-4">
                <input id="coverage-guard-form-name" type="text" placeholder="الاسم الكامل" class="p-2 border bg-slate-700 border-slate-600 rounded-md sm:col-span-2">
                <input id="coverage-guard-form-national-id" type="text" placeholder="رقم الهوية" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                <input id="coverage-guard-form-mobile" type="text" placeholder="رقم الجوال" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                <input id="coverage-guard-form-password" type="text" placeholder="كلمة المرور" class="p-2 border bg-slate-700 border-slate-600 rounded-md sm:col-span-2">
            </div>
            <div class="p-4 bg-slate-900 flex justify-end gap-3">
                <button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button>
                <button id="submit-coverage-guard-form-btn" class="font-semibold bg-blue-600 text-white px-4 py-2 rounded-lg transition hover:bg-blue-700">حفظ</button>
            </div>
        </div>
        
        <div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="coverage-site-form-modal">
            <h3 id="coverage-site-form-title" class="text-xl font-bold p-4 border-b border-slate-700"></h3>
            <input type="hidden" id="coverage-site-form-id">
            <div class="p-6 grid grid-cols-1 sm:grid-cols-2 gap-4">
                <input id="coverage-site-project" type="text" placeholder="المشروع" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                <input id="coverage-site-location" type="text" placeholder="الموقع" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                <div class="sm:col-span-2">
                     <label for="coverage-site-date" class="block text-sm font-medium text-gray-300 mb-1">التاريخ</label>
                     <input id="coverage-site-date" type="date" class="p-2 w-full border bg-slate-700 border-slate-600 rounded-md">
                </div>
                 <div class="sm:col-span-2">
                     <label for="coverage-site-day" class="block text-sm font-medium text-gray-300 mb-1">اليوم</label>
                     <select id="coverage-site-day" class="filter-select">
                         <option value="السبت">السبت</option>
                         <option value="الأحد">الأحد</option>
                         <option value="الإثنين">الإثنين</option>
                         <option value="الثلاثاء">الثلاثاء</option>
                         <option value="الأربعاء">الأربعاء</option>
                         <option value="الخميس">الخميس</option>
                         <option value="الجمعة">الجمعة</option>
                     </select>
                </div>
                 <div>
                     <label for="coverage-site-start-time" class="block text-sm font-medium text-gray-300 mb-1">من</label>
                     <input id="coverage-site-start-time" type="time" class="p-2 w-full border bg-slate-700 border-slate-600 rounded-md">
                </div>
                 <div>
                     <label for="coverage-site-end-time" class="block text-sm font-medium text-gray-300 mb-1">إلى</label>
                     <input id="coverage-site-end-time" type="time" class="p-2 w-full border bg-slate-700 border-slate-600 rounded-md">
                </div>
                <div class="sm:col-span-2">
                    <label for="coverage-site-payout" class="block text-sm font-medium text-gray-300 mb-1">المبلغ المستحق</label>
                    <input id="coverage-site-payout" type="number" placeholder="المبلغ" class="p-2 w-full border bg-slate-700 border-slate-600 rounded-md">
                </div>
            </div>
            <div class="p-4 bg-slate-900 flex justify-end gap-3">
                <button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button>
                <button id="submit-coverage-site-form-btn" class="font-semibold bg-blue-600 text-white px-4 py-2 rounded-lg transition hover:bg-blue-700">حفظ</button>
            </div>
        </div>

        <div class="modal-content flex-col w-full max-w-4xl bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="contract-form-modal">
     <h3 id="contract-form-title" class="text-xl font-bold p-4 border-b border-slate-700"></h3>
     <div class="flex-grow p-6 space-y-6 max-h-[80vh] overflow-y-auto">
         <input type="hidden" id="contract-form-id">
         <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
             <input id="contract-form-company-name" type="text" placeholder="اسم الشركة (الطرف الثاني)" class="p-2 border bg-slate-700 border-slate-600 rounded-md sm:col-span-2">
             <input id="contract-form-region" type="text" placeholder="المنطقة" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
             <input id="contract-form-location" type="text" placeholder="الموقع" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
             <input id="contract-form-project" type="text" placeholder="المشروع" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
             <input id="contract-form-guards-count" type="number" placeholder="عدد الحراس المطلوب" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
             <input id="contract-form-duration" type="text" placeholder="مدة العقد" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
             <input id="contract-form-value" type="number" placeholder="قيمة العقد" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
             <div>
                 <label for="contract-form-start-date" class="block text-sm font-medium text-gray-300 mb-1">تاريخ بداية العقد</label>
                 <input id="contract-form-start-date" type="date" class="p-2 w-full border bg-slate-700 border-slate-600 rounded-md">
             </div>
             <div>
                 <label for="contract-form-end-date" class="block text-sm font-medium text-gray-300 mb-1">تاريخ نهاية العقد</label>
                 <input id="contract-form-end-date" type="date" class="p-2 w-full border bg-slate-700 border-slate-600 rounded-md">
             </div>
             <div class="sm:col-span-2">
                 <label for="contract-form-status" class="block text-sm font-medium text-gray-300 mb-1">حالة العقد</label>
                 <select id="contract-form-status" class="filter-select">
                     <option value="نشط">نشط</option>
                     <option value="منتهي">منتهي</option>
                     <option value="متوقف">متوقف</option>
                 </select>
             </div>
             <textarea id="contract-form-notes" rows="3" placeholder="ملاحظات اخرى (اتركه فارغاً اذا لم يكن هناك ملاحظات)" class="p-2 w-full border bg-slate-700 border-slate-600 rounded-md sm:col-span-2"></textarea>
         </div>
         <!-- Dynamic Clauses Section -->
         <fieldset class="border border-slate-600 p-4 rounded-lg">
            <legend class="px-2 font-semibold text-gray-300">بنود العقد</legend>
            <div id="clauses-container" class="space-y-4">
                <!-- Clause groups will be added here -->
            </div>
            <button id="add-clause-group-btn" type="button" class="mt-4 text-sm text-blue-400 hover:text-blue-300 flex items-center gap-2"><i class="ph ph-plus-circle"></i> إضافة مجموعة بنود جديدة</button>
         </fieldset>
     </div>
     <div class="p-4 bg-slate-900 flex justify-end gap-3">
         <button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button>
         <button id="submit-contract-form-btn" class="font-semibold bg-blue-600 text-white px-4 py-2 rounded-lg transition hover:bg-blue-700">حفظ العقد</button>
     </div>
</div>

        <div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="staff-form-modal">
            <h3 id="staff-form-title" class="text-xl font-bold p-4 border-b border-slate-700"></h3>
            <input type="hidden" id="staff-form-id">
            <input type="hidden" id="staff-form-role">
            <div class="p-6 grid grid-cols-1 sm:grid-cols-2 gap-4">
                <input id="staff-form-name" type="text" placeholder="الاسم الكامل" class="p-2 border bg-slate-700 border-slate-600 rounded-md sm:col-span-2">
                <input id="staff-form-username" type="text" placeholder="اسم المستخدم / رقم الهوية" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                <input id="staff-form-password" type="text" placeholder="كلمة المرور (اتركه فارغاً)" class="p-2 border bg-slate-700 border-slate-600 rounded-md">
                <div id="staff-form-title-container" class="sm:col-span-2">
                    <label for="staff-form-title-input" class="block text-sm font-medium text-gray-300 mb-2">المسمى الوظيفي</label>
                    <input id="staff-form-title-input" type="text" placeholder="المسمى الوظيفي" class="p-2 w-full border bg-slate-700 border-slate-600 rounded-md">
                </div>
                <div id="staff-form-assignment-container" class="sm:col-span-2 space-y-3">
                    <label class="block text-sm font-medium text-gray-300">المشاريع المسندة</label>
                    <div id="staff-form-assignments-list"></div>
                    <button id="add-assignment-btn" class="text-sm text-blue-400 hover:text-blue-300">+ إضافة مشروع آخر</button>
                </div>
            </div>
            <div class="p-4 bg-slate-900 flex justify-end gap-3">
                <button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button>
                <button id="submit-staff-form-btn" class="font-semibold bg-blue-600 text-white px-4 py-2 rounded-lg transition hover:bg-blue-700">حفظ</button>
            </div>
        </div>
        
         <div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="financial-transaction-modal">
            <h3 id="financial-transaction-title" class="text-xl font-bold p-4 border-b border-slate-700"></h3>
            <div class="p-6 space-y-4">
                <input type="hidden" id="financial-transaction-guard-id">
                 <input type="hidden" id="financial-transaction-type">
                <div>
                    <label for="financial-transaction-amount" class="block text-sm font-medium text-gray-300 mb-2">المبلغ</label>
                    <input id="financial-transaction-amount" type="number" placeholder="ادخل المبلغ" class="p-2 w-full border bg-slate-700 border-slate-600 rounded-md">
                </div>
                 <div>
                    <label for="financial-transaction-reason" class="block text-sm font-medium text-gray-300 mb-2">السبب</label>
                    <textarea id="financial-transaction-reason" rows="3" placeholder="ادخل سبب الإجراء" class="p-2 w-full border bg-slate-700 border-slate-600 rounded-md"></textarea>
                </div>
            </div>
            <div class="p-4 bg-slate-900 flex justify-end gap-3">
                <button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button>
                <button id="submit-financial-transaction-btn" class="font-semibold bg-blue-600 text-white px-4 py-2 rounded-lg transition hover:bg-blue-700">تأكيد</button>
            </div>
        </div>

        <div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="schedule-display-modal">
            <h3 id="schedule-modal-title" class="text-xl font-bold p-4 border-b border-slate-700">جدول الدوام</h3>
            <div id="schedule-modal-body" class="p-6"></div>
            <div class="p-4 bg-slate-900 flex justify-end gap-3"><button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button></div>
        </div>
        
        <div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="coverage-notes-modal">
              <h3 class="text-xl font-bold p-4 border-b border-slate-700">إضافة ملاحظات</h3>
              <div class="p-6 space-y-4">
                  <input type="hidden" id="coverage-notes-coverage-id">
                  <label for="coverage-notes-textarea" class="block text-sm font-medium text-gray-300 mb-2">ملاحظات (اختياري، اتركه فارغاً إذا لم يكن هناك ملاحظات)</label>
                  <textarea id="coverage-notes-textarea" rows="4" class="w-full p-2 border bg-slate-700 border-slate-600 rounded-md"></textarea>
              </div>
              <div class="p-4 bg-slate-900 flex justify-end gap-3">
                  <button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إلغاء</button>
                  <button id="submit-coverage-notes-btn" class="font-semibold bg-blue-600 text-white px-4 py-2 rounded-lg transition hover:bg-blue-700">تأكيد التقديم</button>
              </div>
        </div>
<div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="edit-attendance-modal">
    <h3 class="text-xl font-bold p-4 border-b border-slate-700">تعديل سجل الحضور</h3>
    <div class="p-6 space-y-4">
        <input type="hidden" id="edit-attendance-id">
        <div>
            <label for="edit-checkin-time" class="block text-sm font-medium text-gray-300 mb-2">وقت الحضور</label>
            <input type="datetime-local" id="edit-checkin-time" class="p-2 w-full border bg-slate-700 border-slate-600 rounded-md">
        </div>
        <div>
            <label for="edit-checkout-time" class="block text-sm font-medium text-gray-300 mb-2">وقت الانصراف (اتركه فارغًا إذا لم ينصرف بعد)</label>
            <input type="datetime-local" id="edit-checkout-time" class="p-2 w-full border bg-slate-700 border-slate-600 rounded-md">
        </div>
        <div>
            <label for="edit-attendance-notes" class="block text-sm font-medium text-gray-300 mb-2">الملاحظات</label>
            <textarea id="edit-attendance-notes" rows="3" class="w-full p-2 border bg-slate-700 border-slate-600 rounded-md"></textarea>
        </div>
    </div>
    <div class="p-4 bg-slate-900 flex justify-end gap-3">
        <button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button>
        <button id="submit-attendance-edit-btn" class="font-semibold bg-blue-600 text-white px-4 py-2 rounded-lg transition hover:bg-blue-700">حفظ التعديلات</button>
    </div>
</div>
        <div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="leave-modal">
              <h3 class="text-xl font-bold p-4 border-b border-slate-700">طلب إجازة</h3><div class="p-6 space-y-4"><label for="leave-days" class="block">عدد الأيام المطلوبة</label><input type="number" id="leave-days" class="w-full p-2 border bg-slate-700 border-slate-600 rounded-md" min="1"><label for="leave-reason" class="block">السبب</label><textarea id="leave-reason" rows="3" class="w-full p-2 border bg-slate-700 border-slate-600 rounded-md"></textarea></div>
              <div class="p-4 bg-slate-900 flex justify-end gap-3"><button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button><button id="submit-leave-btn" class="font-semibold bg-blue-600 text-white px-4 py-2 rounded-lg transition hover:bg-blue-700">إرسال الطلب</button></div>
        </div>
        <div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="loan-modal">
              <h3 class="text-xl font-bold p-4 border-b border-slate-700">طلب سلفة</h3><div class="p-6 space-y-4"><label for="loan-amount" class="block">المبلغ المطلوب</label><input type="number" id="loan-amount" class="w-full p-2 border bg-slate-700 border-slate-600 rounded-md" min="1"><label for="loan-reason" class="block">السبب</label><textarea id="loan-reason" rows="3" class="w-full p-2 border bg-slate-700 border-slate-600 rounded-md"></textarea></div>
              <div class="p-4 bg-slate-900 flex justify-end gap-3"><button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button><button id="submit-loan-btn" class="font-semibold bg-blue-600 text-white px-4 py-2 rounded-lg transition hover:bg-blue-700">إرسال الطلب</button></div>
        </div>
        <div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="permission-modal">
              <h3 class="text-xl font-bold p-4 border-b border-slate-700">طلب استئذان</h3><div class="p-6 space-y-4"><label for="permission-reason" class="block">سبب الاستئذان</label><textarea id="permission-reason" rows="3" class="w-full p-2 border bg-slate-700 border-slate-600 rounded-md"></textarea></div>
              <div class="p-4 bg-slate-900 flex justify-end gap-3"><button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button><button id="submit-permission-btn" class="font-semibold bg-blue-600 text-white px-4 py-2 rounded-lg transition hover:bg-blue-700">إرسال الطلب</button></div>
        </div>
        <div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="overtime-modal">
              <h3 class="text-xl font-bold p-4 border-b border-slate-700">طلب عمل إضافي</h3><div class="p-6 space-y-4"><label for="overtime-reason" class="block">تفاصيل العمل الإضافي المطلوب</label><textarea id="overtime-reason" rows="3" class="w-full p-2 border bg-slate-700 border-slate-600 rounded-md"></textarea></div>
              <div class="p-4 bg-slate-900 flex justify-end gap-3"><button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button><button id="submit-overtime-btn" class="font-semibold bg-blue-600 text-white px-4 py-2 rounded-lg transition hover:bg-blue-700">إرسال الطلب</button></div>
        </div>
        <div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="resignation-modal">
              <h3 class="text-xl font-bold p-4 border-b border-slate-700">طلب استقالة</h3><div class="p-6 space-y-4"><label for="resignation-reason" class="block">سبب الاستقالة</label><textarea id="resignation-reason" rows="4" class="w-full p-2 border bg-slate-700 border-slate-600 rounded-md"></textarea></div>
              <div class="p-4 bg-slate-900 flex justify-end gap-3"><button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button><button id="submit-resignation-btn" class="font-semibold bg-red-600 text-white px-4 py-2 rounded-lg transition hover:bg-red-700">تقديم طلب الاستقالة</button></div>
        </div>
        
        <div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="transfer-request-modal">
             <h3 class="text-xl font-bold p-4 border-b border-slate-700">رفع طلب نقل حارس</h3>
             <div class="p-6 space-y-4">
                 <div>
                     <label for="transfer-guard-select" class="block text-sm font-medium text-gray-300 mb-2">اختر الحارس</label>
                     <select id="transfer-guard-select" class="filter-select"></select>
                 </div>
                 <div>
                     <label for="transfer-new-location" class="block text-sm font-medium text-gray-300 mb-2">الموقع الجديد</label>
                     <input type="text" id="transfer-new-location" class="p-2 w-full border bg-slate-700 border-slate-600 rounded-md">
                 </div>
                  <div>
                     <label for="transfer-new-project" class="block text-sm font-medium text-gray-300 mb-2">المشروع الجديد</label>
                     <input type="text" id="transfer-new-project" class="p-2 w-full border bg-slate-700 border-slate-600 rounded-md">
                 </div>
                  <div>
                     <label for="transfer-reason" class="block text-sm font-medium text-gray-300 mb-2">سبب النقل</label>
                     <textarea id="transfer-reason" rows="3" class="w-full p-2 border bg-slate-700 border-slate-600 rounded-md"></textarea>
                 </div>
             </div>
             <div class="p-4 bg-slate-900 flex justify-end gap-3">
                 <button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button>
                 <button id="submit-transfer-request-btn" class="font-semibold bg-blue-600 text-white px-4 py-2 rounded-lg transition hover:bg-blue-700">إرسال الطلب</button>
             </div>
        </div>

        <div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="rejection-reason-modal">
              <h3 class="text-xl font-bold p-4 border-b border-slate-700">سبب الرفض</h3>
              <div class="p-6 space-y-4">
                  <input type="hidden" id="rejection-item-id">
                  <input type="hidden" id="rejection-table-name">
                  <div>
                      <label for="rejection-reason-input" class="block text-sm font-medium text-gray-300 mb-2">يرجى ذكر سبب رفض الطلب</label>
                      <textarea id="rejection-reason-input" rows="4" class="w-full p-2 border bg-slate-700 border-slate-600 rounded-md"></textarea>
                  </div>
              </div>
              <div class="p-4 bg-slate-900 flex justify-end gap-3">
                  <button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إلغاء</button>
                  <button id="submit-rejection-btn" class="font-semibold bg-red-600 text-white px-4 py-2 rounded-lg transition hover:bg-red-700">تأكيد الرفض</button>
              </div>
        </div>
        
        <div class="modal-content flex-col w-full max-w-lg bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="attendance-modal">
            <h3 class="text-xl font-bold p-4 border-b border-slate-700">تسجيل حضور</h3>
            <div class="p-6 space-y-4">
                <label for="guard-notes" class="block">ملاحظات (اختياري)</label>
                <textarea id="guard-notes" rows="3" class="w-full p-2 border bg-slate-700 border-slate-600 rounded-md"></textarea>
            </div>
            <div class="p-4 bg-slate-900 flex justify-end gap-3">
                <button class="modal-close-btn font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">إغلاق</button>
                <button id="submit-attendance-btn" class="font-semibold bg-blue-600 text-white px-4 py-2 rounded-lg transition hover:bg-blue-700">تأكيد الحضور</button>
            </div>
        </div>

        <div class="modal-content flex-col w-full max-w-sm bg-slate-800 text-white border border-slate-700 rounded-lg shadow-xl" id="confirm-modal">
            <h3 id="confirm-title" class="text-xl font-bold p-4">تأكيد الإجراء</h3><p id="confirm-message" class="p-6 text-lg"></p><div class="p-4 bg-slate-900 flex justify-end gap-3"><button id="confirm-cancel-btn" class="font-semibold bg-slate-600 text-white px-4 py-2 rounded-lg transition hover:bg-slate-500">لا</button><button id="confirm-ok-btn" class="font-semibold bg-red-600 text-white px-4 py-2 rounded-lg transition hover:bg-red-700">نعم</button></div>
        </div>
    </div>
    
    <div id="alert-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50 p-4"><div class="bg-slate-800 border border-slate-600 rounded-lg shadow-xl p-6 text-center w-full max-w-sm"><p id="alert-message" class="text-lg mb-6 text-white"></p><button id="alert-close-btn" class="bg-blue-600 text-white px-8 py-2 rounded-lg hover:bg-blue-700">موافق</button></div></div>
    <div id="loading-overlay" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50"><div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-white"></div></div>

    <script src="app.js"></script>
</body>
</html>
